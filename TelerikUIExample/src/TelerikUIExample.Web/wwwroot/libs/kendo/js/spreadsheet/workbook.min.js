module.exports=function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){n(1704),e.exports=n(1704)},3:function(e,t){e.exports=function(){throw Error("define cannot be used indirect")}},20:function(e,t){e.exports=require("../kendo.core")},1648:function(e,t){e.exports=require("./runtime")},1676:function(e,t){e.exports=require("./references")},1704:function(e,t,n){var i,s,o;!function(r,define){s=[n(20),n(1648),n(1676),n(1705)],i=r,o="function"==typeof i?i.apply(t,s):i,!(void 0!==o&&(e.exports=o))}(function(){!function(e){function t(e,t){var n=new XMLHttpRequest;n.onload=function(){t(n.response,n.getResponseHeader("Content-Type"))},n.onerror=function(){t(null)},n.open("GET",e),n.responseType="arraybuffer",n.send()}function n(e,t){function n(e,t,n){return void 0!==e?e:void 0!==t?t:n}var i,s,o,r,h,a,d=n(e.rowCount,t.rows,200),u=n(e.columnCount,t.columns,50),c=n(e.rowHeight,t.rowHeight,20),l=n(e.columnWidth,t.columnWidth,64),f=n(e.headerHeight,t.headerHeight,20),m=n(e.headerWidth,t.headerWidth,32);if(void 0!==e.rows)for(i=0;i<e.rows.length;++i)if(s=e.rows[i],o=n(s.index,i),o>=d&&(d=o+1),s.cells)for(r=0;r<s.cells.length;++r)h=s.cells[r],a=n(h.index,r),a>=u&&(u=a+1);return{rowCount:d,columnCount:u,rowHeight:c,columnWidth:l,headerHeight:f,headerWidth:m}}var i,s=e.jQuery,o=e.spreadsheet.calc.runtime.Formula,r=e.spreadsheet.Ref,h=e.spreadsheet.CalcError;e.spreadsheet.messages.workbook={defaultSheetName:"Sheet"},i=e.Observable.extend({options:{},init:function(t,n){e.Observable.fn.init.call(this),this.options=t,this._view=n,this._sheets=[],this._images={},this._imgID=0,this._sheetsSearchCache={},this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource}),this.undoRedoStack=new e.util.UndoRedoStack,this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this)),this._context=new e.spreadsheet.FormulaContext(this),this._validationContext=new e.spreadsheet.ValidationFormulaContext(this),this._names=Object.create(null),this.fromJSON(this.options)},clipboard:function(){return this._clipboard||(this._clipboard=new e.spreadsheet.Clipboard(this)),this._clipboard},destroy:function(){this.unbind(),this._clipboard&&this._clipboard.destroy()},events:["cut","copy","paste","changing","change","excelImport","excelExport","insertSheet","removeSheet","selectSheet","renameSheet","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","changeFormat","dataBinding","dataBound","progress"],_sheetChanging:function(e){this.trigger("changing",e)&&e.preventDefault()},_sheetChange:function(e){this.trigger("change",e)},_sheetInsertRow:function(e){this.trigger("insertRow",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetInsertColumn:function(e){this.trigger("insertColumn",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetDeleteRow:function(e){this.trigger("deleteRow",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetDeleteColumn:function(e){this.trigger("deleteColumn",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetHideRow:function(e){this.trigger("hideRow",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetHideColumn:function(e){this.trigger("hideColumn",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetUnhideRow:function(e){this.trigger("unhideRow",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetUnhideColumn:function(e){this.trigger("unhideColumn",{sheet:e.sender,index:e.index})&&e.preventDefault()},_sheetSelect:function(e){this.trigger("select",e)},_sheetDataBinding:function(e){this.trigger("dataBinding",{sheet:e.sender})&&e.preventDefault()},_sheetDataBound:function(e){this.trigger("dataBound",{sheet:e.sender})},_sheetProgress:function(e){var t=this;setTimeout(function(){t.trigger("progress",{toggle:e.toggle})})},_sheetCommandRequest:function(e){this.trigger("commandRequest",e)},_inputForRef:function(t){var n=this;return n._sheet.withCultureDecimals(function(){return new e.spreadsheet.Range(t,n._sheet).input()})},_onUndoRedo:function(e){e.command.range().select()},execute:function(t){var n,i=s.extend({workbook:this},t.options),o=new e.spreadsheet[t.command](i),r=this.activeSheet();return i.origin&&o.origin(i.origin),o.range(i.operatingRange?i.operatingRange:r.selection()),i.editRange&&(o._editRange=i.editRange),n=o.exec(),n&&"error"===n.reason||o.cannotUndo||this.undoRedoStack.push(o),this.cleanupImages(),n},resetFormulas:function(){this._sheets.forEach(function(e){e.resetFormulas()})},resetValidations:function(){this._sheets.forEach(function(e){e.resetValidations()})},refresh:function(e){e.recalc&&(this.resetFormulas(),this.resetValidations(),this._sheet.recalc(this._context),this._sheet.revalidate(this._validationContext))},activeSheet:function(t){return void 0===t?this._sheet:void(this.sheetByName(t.name())&&(this._sheet=t,t.triggerChange(e.spreadsheet.ALL_REASONS)))},moveSheetToIndex:function(e,t){var n=this.sheetIndex(e),i=this._sheets;n!==-1&&(this._sheetsSearchCache={},i.splice(t,0,i.splice(n,1)[0]),this.trigger("change",{sheetSelection:!0}))},insertSheet:function(t){var n,i,s,o,r,h;if(t=t||{},n=this,i="number"==typeof t.index?t.index:n._sheets.length,o=n._sheets,r=function(t){t=t?t:1;var i=e.spreadsheet.messages.workbook.defaultSheetName+t;return n.sheetByName(i)?r(t+1):i},!t.name||!n.sheetByName(t.name))return this._sheetsSearchCache={},s=t.name||r(),h=new e.spreadsheet.Sheet(t.rows||this.options.rows,t.columns||this.options.columns,t.rowHeight||this.options.rowHeight,t.columnWidth||this.options.columnWidth,t.headerHeight||this.options.headerHeight,t.headerWidth||this.options.headerWidth,t.defaultCellStyle||this.options.defaultCellStyle),h._workbook=this,h._name(s),this._bindSheetEvents(h),o.splice(i,0,h),t.data&&h.fromJSON(t.data),t.dataSource&&h.setDataSource(t.dataSource),this.trigger("change",{sheetSelection:!0}),h},_bindSheetEvents:function(e){e.bind("changing",this._sheetChanging.bind(this)),e.bind("change",this._sheetChange.bind(this)),e.bind("insertRow",this._sheetInsertRow.bind(this)),e.bind("insertColumn",this._sheetInsertColumn.bind(this)),e.bind("deleteRow",this._sheetDeleteRow.bind(this)),e.bind("deleteColumn",this._sheetDeleteColumn.bind(this)),e.bind("hideRow",this._sheetHideRow.bind(this)),e.bind("hideColumn",this._sheetHideColumn.bind(this)),e.bind("unhideRow",this._sheetUnhideRow.bind(this)),e.bind("unhideColumn",this._sheetUnhideColumn.bind(this)),e.bind("select",this._sheetSelect.bind(this)),e.bind("commandRequest",this._sheetCommandRequest.bind(this)),e.bind("dataBinding",this._sheetDataBinding.bind(this)),e.bind("dataBound",this._sheetDataBound.bind(this)),e.bind("progress",this._sheetProgress.bind(this))},sheets:function(){return this._sheets.slice()},sheetByName:function(e){return this._sheets[this.sheetIndex(e)]},sheetByIndex:function(e){return this._sheets[e]},sheetIndex:function(e){var t,n=this._sheets,i=("string"==typeof e?e:e.name()).toLowerCase(),s=this._sheetsSearchCache[i];if(s>=0)return s;for(s=0;s<n.length;s++)if(t=n[s].name().toLowerCase(),this._sheetsSearchCache[t]=s,t===i)return s;return-1},renameSheet:function(e,t){var n=e.name().toLowerCase();if(t&&n!==t.toLowerCase()&&!this.sheetByName(t)&&(e=this.sheetByName(n),e&&(this._sheetsSearchCache={},!this.trigger("renameSheet",{sheet:e,newSheetName:t}))))return this._sheets.forEach(function(e){e._forFormulas(function(e){e.renameSheet(n,t)})}),this.forEachName(function(e,i){e.nameref.renameSheet(n,t)&&(this.undefineName(i),e.name=e.nameref.print(),this.nameDefinition(e.name,e)),(e.value instanceof r||e.value instanceof o)&&e.value.renameSheet(n,t)}.bind(this)),e._name(t),this.trigger("change",{sheetSelection:!0}),e},removeSheet:function(e){var t,n=this,i=n._sheets,s=e.name(),o=n.sheetIndex(e);1!==i.length&&(this.trigger("removeSheet",{sheet:e})||(this._sheetsSearchCache={},o>-1&&(e.unbind(),i.splice(o,1),n.activeSheet().name()===s?(t=i[o===i.length?o-1:o],n.activeSheet(t)):this.trigger("change",{recalc:!0,sheetSelection:!0}))))},_clearSheets:function(){for(var e=0;e<this._sheets.length;e++)this._sheets[e]._activeDrawing=[],this._sheets[e]._drawings=[],this._sheets[e].unbind();this._sheets=[],this._sheetsSearchCache={},this._names={},this._images={},this._imgID=0},fromJSON:function(e){var t,i,s,o;if(e.sheets)for(this._clearSheets(),e.images&&(this._imgID=0,this._images={},Object.keys(e.images).forEach(function(t){if(!isNaN(t)){var n=parseFloat(t);isFinite(n)&&(this._imgID=Math.max(this._imgID,n))}this._images[t]={url:e.images[t]}},this)),t=0;t<e.sheets.length;t++)i=e.sheets[t],s=n(i,this.options),o=this.insertSheet({rows:s.rowCount,columns:s.columnCount,rowHeight:s.rowHeight,columnWidth:s.columnWidth,headerHeight:s.headerHeight,headerWidth:s.headerWidth,data:i}),i.dataSource&&o.setDataSource(i.dataSource);this.activeSheet(e.activeSheet?this.sheetByName(e.activeSheet):this._sheets[0]),e.names&&e.names.forEach(function(e){this.defineName(e.name,e.value,e.hidden)},this)},toJSON:function(){this.resetFormulas(),this.resetValidations();var e=Object.keys(this._names).map(function(e){var t=this._names[e],n=t.value;return n instanceof r||n instanceof o?n=n.print(0,0,!0):n instanceof h?n+="":n=JSON.stringify(n),{value:n,hidden:t.hidden,name:t.name,sheet:t.nameref.sheet,localName:t.nameref.name}},this);return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(e){return e.recalc(this._context),e.revalidate(this._validationContext),e.toJSON()},this),names:e,columnWidth:this.options.columnWidth,rowHeight:this.options.rowHeight}},saveJSON:function(){function e(){--r<=0&&n.resolve(i)}var t=this,n=new s.Deferred,i=t.toJSON(),o=Object.keys(t._images).filter(function(e){return 1===t.usesImage(e)}),r=o.length;return i.images={},r?o.forEach(function(n){var s,o=t._images[n];o.blob?(s=new FileReader,s.onload=function(){i.images[n]=s.result,e()},s.readAsDataURL(o.blob)):(i.images[n]=o.url,e())}):e(),n.promise()},fromFile:function(t){var n=new s.Deferred,i=n.promise(),o={file:t,promise:i};return t&&!this.trigger("excelImport",o)?(this._clearSheets(),e.spreadsheet.readExcel(t,this,n)):n.reject(),i},saveAsExcel:function(n){function i(){if(--h<=0){o.images=a;var t=new e.ooxml.Workbook(o);e.saveAs({dataURI:n.forceProxy?t.toDataURL():t.toBlob(),fileName:o.fileName||n.fileName,proxyURL:n.proxyURL,forceProxy:n.forceProxy})}}var o,r,h,a,d=this;n=s.extend({},d.options.excel,n),o=d.toJSON(),d.trigger("excelExport",{workbook:o})||(r=Object.keys(d._images).filter(function(e){return 1===d.usesImage(e)}),h=r.length,a=h?{}:null,h?r.forEach(function(e){var n,s=d._images[e];s.blob?(n=new FileReader,n.onload=function(){a[e]={type:s.blob.type,name:s.blob.name,data:n.result},i()},n.readAsArrayBuffer(s.blob)):t(s.url,function(t,n){a[e]={type:n,data:t},i()})}):i())},draw:function(t,n){"function"!=typeof t||n||(n=t,t={});var i=[],s=this._sheets;!function o(r){if(r<s.length)s[r].draw(e.spreadsheet.SHEETREF,t,function(e){i.push(e),o(r+1)});else{var h=i[0];for(r=1;r<i.length;++r)h.children=h.children.concat(i[r].children);n(h)}}(0)},nameForRef:function(e,t){var n,i,s,o;void 0===t&&(t=e.sheet),t=t.toLowerCase(),n=e+"";for(i in this._names)if(s=this._names[i],o=s.value,o instanceof r&&(!o.sheet||o.sheet&&t==o.sheet.toLowerCase())&&o+""==n)return s;return{name:n}},defineName:function(t,n,i){var s=e.spreadsheet.calc.parseNameDefinition(t,n);t=s.name.print(),this._names[t.toLowerCase()]={value:s.value,hidden:i,name:t,nameref:s.name}},undefineName:function(e){delete this._names[e.toLowerCase()]},nameValue:function(e){return e=e.toLowerCase(),e in this._names?this._names[e].value:null},nameDefinition:function(e,t){return e=e.toLowerCase(),arguments.length>1&&(void 0===t?delete this._names[e]:this._names[e]=t),this._names[e]},forEachName:function(e){Object.keys(this._names).forEach(function(t){e(this._names[t],t)},this)},adjustNames:function(e,t,n,i){e=e.toLowerCase(),Object.keys(this._names).forEach(function(s){var h=this._names[s],a=h.value;a instanceof r&&a.sheet.toLowerCase()==e?h.value=a.adjust(null,null,null,null,t,n,i):a instanceof o&&a.adjust(e,t?"row":"col",n,i)},this)},addImage:function(e){var t=++this._imgID+"";return this._images[t]="string"==typeof e?{url:e}:{blob:e},t},imageUrl:function(e){var t=this._images[e],n=t.url;return n||(n=t.url=window.URL.createObjectURL(t.blob)),n},cleanupImages:function(){Object.keys(this._images).forEach(function(e){if(!this.usesImage(e)){var t=this._images[e].url;t&&window.URL.revokeObjectURL(t),delete this._images[e]}},this)},usesImage:function(e){var t,n,i=this._sheets;for(t=i.length;--t>=0;)if(i[t].usesImage(e))return 1;for(n=this.undoRedoStack.stack,t=n.length;--t>=0;)if(n[t].usesImage(e))return 2;return!1}}),e.spreadsheet.Workbook=i,e.PDFMixin&&(e.PDFMixin.extend(i.prototype),i.prototype.saveAsPDF=function(t){var n=new s.Deferred,i=n.promise(),o={promise:i};if(!this.trigger("pdfExport",o))return this._drawPDF(t,n).then(function(n){return t.forceProxy?e.pdf.exportPDF(n):e.pdf.exportPDFToBlob(n)}).done(function(i){e.saveAs({dataURI:i,fileName:t.fileName,proxyURL:t.proxyURL,forceProxy:t.forceProxy,proxyTarget:t.proxyTarget}),n.resolve()}).fail(function(e){n.reject(e)}),i},i.prototype._drawPDF=function(e){var t=new s.Deferred,n=function(e){t.resolve(e)};switch(e.area){case"workbook":e.workbook.draw(e,n);break;case"sheet":e.workbook.activeSheet().draw(e,n);break;case"selection":e.workbook.activeSheet().selection().draw(e,n)}return t.promise()})}(kendo)},n(3))},1705:function(e,t){e.exports=require("./excel-reader")}});